% !TEX option = -shell-escape
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This work is licensed under the Creative Commons Attribution 4.0
% International License. To view a copy of this license, visit
% http://creativecommons.org/licenses/by/4.0/.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[12pt]{ussci}

\usepackage{todonotes}

\newcommand\ck{ChemKED}
\newcommand\pk{PyKED}

\usepackage[inline]{enumitem}
\setlist{noitemsep}

\usepackage{microtype}
%======================================================================
\addbibresource{pyked.bib}
%======================================================================
\newcommand\papertopic{Reaction Kinetics}
%======================================================================

\title{ ChemKED: a human- and machine-readable data standard for chemical kinetics experiments }

\author[1*]{Bryan W. Weber}
\author[2]{Kyle E. Niemeyer}

\affil[1]{Department of Mechanical Engineering, University of Connecticut, Storrs, CT, USA}
\affil[2]{School of Mechanical, Industrial, and Manufacturing Engineering, Oregon State University, Corvallis, OR, USA}
\affil[*]{Corresponding author: \email{bryan.weber@uconn.edu}}

\begin{document}
\maketitle

%====================================================================
\begin{abstract} % not to exceed 200 words
Fundamental experimental measurements of quantities including ignition delay
times, laminar flame speeds, and species profiles serve important roles in
understanding fuel chemistry and validating chemical kinetic models. However,
despite both the importance and abundance of such information in the literature,
the community lacks a widely adopted standard format for this data. This impedes
both sharing and wide use by the community. In this talk, we will introduce a
new Chemical Kinetics Experimental Data format, ChemKED, and the related
Python-based package for creating and validating ChemKED-formatted files called
PyKED. We will also review past and related efforts, and motivate the need for a
new solution. ChemKED currently supports the representation of autoignition
delay time and laminar flame speed measurements. ChemKED-formatted files contain
all of the information needed to simulate experimental data points, including
uncertainty. ChemKED is based on the YAML data serialization language, and is
intended as a human- and machine-readable standard for easy creation and
automated use. Development of ChemKED and PyKED occurs openly on GitHub under
the BSD 3-clause license, and contributions from the community are welcome.
Plans for future development include support for experimental data from jet
stirred reactor, extinction, and speciation measurements.
\end{abstract}

% (Provide 2-4 keywords describing your research. Only abbreviations firmly
% established in the field may be used. These keywords will be used for
% sessioning/indexing purposes.)
\begin{keyword}
    chemical kinetics\sep data standard\sep software\sep database
\end{keyword}

%====================================================================
\section{Introduction}
%
Fundamental combustion experiments provide vital data for understanding
fuel chemistry and validating chemical kinetic models. Important measured quantities
include autoignition delay times, laminar flame speeds, and species profiles.
However, despite both the importance and abundance of such information in the literature,
the combustion\slash chemical kinetics community lacks an accepted, commonly used
standard for recording and sharing data from fundamental combustion experiments.\footnote{
Interestingly, this contrasts the situation for chemical kinetic models, where the
CHEMKIN~\autocite{Kee:1996ck} format dominates. Competing standards such as the
Cantera~\autocite{Cantera:2.3.0} CTI format or FlameMaster~\autocite{FlameMaster:ref,FlameMaster:code}
lag behind considerably, although use of the former continually grows due to Cantera's
open availability.
% Similarly, % with more space, discuss JANAF/NASA polynomial standard ?
}

Instead, such data is typically found in under-documented
comma-separated value files and Excel spreadsheets, or contained in PDF tables
rather than as supplementary material associated with a paper.
In the worst case, data is only available in figures and must be digitized by the
use of software such as WebPlotDigitizer.
\todo{give a citation here}
% I think we're already stirring the pot enough, no need to call out
% specific people
% \todo{call out specific examples of these...?}{}
These practices limit the wide use of the valuable, extensive experimental data
available in the literature. Frenklach~\autocite{Frenklach:2007bm} further explained the
benefits of standardized, widely available data for combustion.
In brief, much of combustion\slash chemical kinetics research drives towards the ultimate goal
of developing predictive kinetic models---and ultimately this depends on a community
infrastructure for data and methods.

The combustion community has not yet widely adopted a standard format for experimental data,
but some researchers and groups attempted to solve this problem.\todo[author=Kyle]{this still doesn't read quite right}{}
Most notably, Frenklach developed the PrIMe (\textbf{Pr}ocess \textbf{I}nformatics
\textbf{M}od\textbf{e}l) data format~\autocite{Frenklach:2007bm,You:2011hy} and an associated
online database, the PrIMe Data Warehouse~\autocite{PrIMe}. PrIMe files encode fundamental
combustion experimental data, along with kinetic models and calculated quantities,
using the Extensible Markup Language (XML) standard.

PrIMe~\autocite{Frenklach:2007bm,You:2011hy} has a number of features that make it
a strong standardization format, but suffers from two primary flaws that
prevent wide adoption: (1) the PrIMe standard does not require or support all information
needed to simulate an experiment, including a machine-readable definition of ignition or a
standard way to express the rapid compression machine (RCM) compression process; (2) and
the XML format, intended more as a markup language than data format, presents a barrier
to creating and working with files.
Furthermore, the focus on using internal identifiers for bibliographic references and
species\slash reactions, rather than standard identifiers (e.g., DOIs for scholarly products
and InCHI or SMILES for species), limits usability outside the PrIMe ecosystem.
Finally, the closed and opaque nature of the PrIMe standard and associated Data Warehouse
limit contributions and community development of these and compatible tools.

More recently, Varga et al.~\autocite{Varga2015a,Varga2015b} developed the ReSpecTh standard,
an XML-based format that builds on PrIMe. ReSpecTh adds important features that make files
better standalone representations of experimental data---i.e., more informative by themselves
rather than in concert with a larger system.
For example, where PrIMe used internal bibliographic references, ReSpecTh added a field for
typical bibliographic data. The ReSpecTh standard also provides machine-readable formats
for better specifying ignition experiments, including a definition of autoignition and
either volume histories for RCMs or pressure-rise in shock tubes.
However, being XML-based, ReSpecTh experimental files still suffer from the same usability
issues as PrIMe, and the standard remains closed.
Olm and colleagues used their ReSpecTh-based database to quantify the performance of literature
hydrogen~\autocite{Olm:2014gn} and syngas~\autocite{Olm:2015ch} kinetic models, and more recently
develop improved models for hydrogen\slash syngas~\autocite{Varga:2016gj} and
ethanol~\autocite{Olm:2016et}. In all four cases, they converted numerous experimental datasets
from the literature into the ReSpecTh standard.
\todo[author=Kyle,inline]{how's this?}

Building on the lack of an accepted data standard, limited examples exist of open sharing
of such data. The Clean Combustion Research Center at King Abdullah University of Science
and Technology (KAUST) started the CloudFlame project in 2013~\autocite{Goteng:2013cf}\todo{a few more refs needed}{}
(\url{https://cloudflame.kaust.edu.sa}). CloudFlame does serve as an openly accessible database
for experimental data, available in a standard CSV format, but also goes beyond this by
providing a cloud infrastructure for running simulations based on stored models and data.
While an admirable (and useful) effort, CloudFlame represents another closed system controlled
by a specific institution rather than the community.

In this work, we present a new, open-source, human- and machine-readable data standard for fundamental combustion
experiments, \ck{}, and offer tools for easily working with data encoded in this format.
Niemeyer recently introduced an initial version of the \ck{} format~\autocite{Niemeyer:2016wf},
and in this work we further formalize and develop the standard. We also discuss a related
Python software tool for validating and working with \ck{} files: \pk{}.
Our motivations are similar those of the PrIMe and ReSpecTh teams:
the \ck{} project will enable easy sharing and use of fundamental combustion data,
for the (primary) purposes of developing and validating predictive chemical kinetic models.
However, we make usability a major design focus, and plan to share all data and software openly
to cultivate a community of user-contributors.

%====================================================================
\section{Overview of format}\label{sec:overview-of-format}

The \ck{} file is a YAML-format file. This format offers the advantages of being
human readable, written in plain text, and having parsers in most common
programming languages, including Python, C++, Java, Perl, MATLAB, and many
others. The YAML syntax is quite simple. The basic file structure is made of
mappings, delimited by a colon. The key for the mapping is on the left of the
colon, and the value on the right can be a single value, a sequence of values,
a nested mapping, or some combination of these:

\begin{minted}{yaml}
    key1: value  # Single-value mapping
    key2: [0, 1, 2]  # Mapping with sequence
    key3:  # Alternative sequence format
      - value
      - value
    key4:  # Nested mapping
      key5: 0
\end{minted}

The \yaml|value| can be a string, integer, or floating point number. The type is
inferred from the \yaml|key| when the value is read. The \ck{} format is
designed to include all of the information necessary to simulate a given
experiment and can be broken into two main sections. The first section details
all of the ``meta'' information about the experiment and the \ck{} file. In this
section, the common \yaml|author| mapping is used for any fields where an author
must be specified. The \yaml|author| mapping contains the following fields:
%
\begin{itemize}
    \item \yaml|name| (required, string): The author's full name
    \item \yaml|ORCID| (optional, string): the author's ORCID number
\end{itemize}
%
More generally for the meta information, the required keys in this section
are:
\todo[author=Kyle,inline]{one difference ReSpecTh called out from PrIMe is that
the latter added a copyright line in all files, claiming copyright on the data...
do we want to be incendiary and point out that you can't copyright data?}
%
\begin{itemize}
    \item \yaml|file-author| (required, \yaml|author|-type mapping): The author
    of the \ck{} file
    \item \yaml|file-version| (required, integer): The version of the \ck{} file
    \item \yaml|chemked-version| (required, string): The version of the \ck{}
    schema that this file conforms to
    \item \yaml|reference| (required, mapping): The reference information for
    the article associated with the data in the file. The fields in this
    mapping are:
    \begin{itemize}
        \item \yaml|authors| (required, sequence): A sequence of \yaml|author|
        mappings
        \item \yaml|journal| (required, string): The name of the publishing
        journal
        \item \yaml|year| (required, integer): The year of publication
    \end{itemize}
    \item \yaml|experiment-type| (required, string): One of
    \yaml|ignition delay| or \yaml|flame speed|
    \item \yaml|apparatus| (required, string): The type of apparatus used to
    perform the experiment
\end{itemize}

In addition to the meta information, the data encoded in the \ck{} file is in
a mapping called \yaml|datapoints|. The \yaml|datapoints| mapping contains a
sequence of nested mappings, with the following information for each element of
the sequence:
%
\begin{itemize}
    \item \yaml|temperature| (required, sequence): The temperature of the
    experiment, with units
    \item \yaml|ignition-delay| (optional, sequence): The ignition delay of the
    experiment, with units, if the \yaml|experiment-type| is
    \yaml|ignition delay|
    \item \yaml|flame-speed| (optional, sequence): The flame speed of the
    experiment, with units, if the \yaml|experiment-type| is \yaml|flame speed|
    \item \yaml|pressure| (required, string): The pressure of the experiment,
    with units
    \item \yaml|composition| (required, sequence): The composition of the
    mixture in the experiment, a sequence of mappings with the following fields
    \begin{itemize}
        \item \yaml|species-name| (required, string): The name of the species
        \item \yaml|mole-fraction|, \yaml|mass-fraction|, \yaml|mole-percent|
        (required, float): The mole fraction or percent, or the mass fraction.
        Only one of the three is permitted in a given \yaml|composition|
        sequence.
        \item \yaml|InChI|, \yaml|SMILES|, \yaml|atomic-composition|, or
        \yaml|elemental-composition| (required, string or sequence): The InChI
        or SMILES representing the molecule, or its atomic or elemental
        composition (\yaml|atomic-composition| and \yaml|elemental-composition|
        are synonyms) as a sequence
    \end{itemize}
    \item \yaml|ignition-type| (required, mapping); The type of ignition
    measured in the experiments. The required fields are
    \begin{itemize}
        \item \yaml|type| (required, string): How the ignition delay was
        measured, one of \yaml|d/dt max| to indicate the ignition point is
        found at the maximum of the time derivative of the \yaml|target|, or
        \yaml|max| or \yaml|min| to indicate the ignition point is at the
        maximum or minimum of the \yaml|target|
        \item \yaml|target| (required, string): The target for the type of the
        ignition point, one of \yaml|temperature|, \yaml|pressure|, \yaml|OH|,
        \yaml|OH*|, \yaml|CH|, or \yaml|CH*|
    \end{itemize}
\end{itemize}

Each of the quantities in a datapoint must be specified with units. This should
be done as a single string associated with the first element of the sequence.
The units of the quantity are validated to ensure they have the appropriate
dimensionality for the quanity. In addition, each of the quantities in the
\yaml|datapoint| can optionally be assigned an uncertainty. This uncertainty can
be either absolute or relative, and is specified as elements of the sequence of
the associated key. For example, the absolute uncertainty of the temperature and
the relative uncertainty of the ignition delay might be specified as follows:

\begin{minted}{yaml}
datapoints:
  - temperature:
      - 1100 kelvin
      - uncertainty-type: absolute
        uncertainty: 10 kelvin
    ignition-delay:
      - 10 us
      - uncertainty-type: relative
        uncertainty: 0.1
    ...
\end{minted}

%====================================================================
\section{PyKED architecture}
%
\pk{} is a Python package that currently provides the reference implementation
of the interface to \ck{} files. \pk{} reads \ck{} files, validates their
structure and content, and allows the user to interact with the datapoints
contained in the \ck{} file.

The basic user interface to the \ck{} file in \pk{} is through the
\python|ChemKED| class. The \python|ChemKED| class constructor takes the file
name of a \ck{} file or a Python dictionary containing the contents of a \ck{}
file as its argument. When the file or dictionary is loaded, it is validated to
have the correct format by Cerberus \autocite{cerberus}.

The fields of the \ck{} file are stored as instance attributes of the
\python|ChemKED| class. The following attributes are available with the
appropriate data:
%
\begin{itemize}
    \item \python|chemked_version|, \python|file_version|, \python|file_author|,
    \python|experiment_type|: Stores the values from the \ck{} file
    \item \python|reference|: Instance of a \python|namedtuple| containing all
    the information from the literature reference associated with the data
    \item \python|apparatus|: Instance of a \python|namedtuple| containing all
    the information about the apparatus used to perform the experiment
    \item \python|datapoints|: A Python list of \python|DataPoint| instances
\end{itemize}

The \python|DataPoint| class stores the information associated with a single
data point in the \ck{} file. Similar to the \python|ChemKED| class, the
information from the \ck{} file are stored as attributes of class instances,
including
%
\begin{itemize}
    \item \python|equivalence_ratio|: The value of the equivalence ratio, if
    present. For informational purposes only, no validation is done of the value
    \item \python|ignition_delay|, \python|temperature|, \python|pressure|,
    \python|pressure_rise|: The value of these data are stored as instances of
    the \python|Quantity| class from the Pint \autocite{Grecco2016} package,
    possibly with associated uncertainty
    \item \python|composition|: A list of dictionaries of the species and their
    respective amounts. The values are validated so that \yaml|mole-percent|,
    \yaml|mole-fraction|, or \yaml|mass-fraction| cannot be mixed for a single
    data point, and so that the sum of the values is approximately 1.0, or
    100.0 for \yaml|mole-percent|.
    \item \python|composition_type|: A string indicating the type of composition
    information for the data point---one of \python|'mole-percent'|,
    \python|'mole-fraction'|, or \python|'mass-fraction'|
    \item \python|volume_history|: If the \yaml|volume-history| of an RCM
    experiment is provided in the \ck{} file, it is stored in this attribute as
    a \python|namedtuple|, and the actual values are stored in NumPy arrays
    \autocite{vanderWalt:2011np}.
\end{itemize}

The \python|DataPoint| class has two instance methods defined, called
\python|get_cantera_mole_fraction| and \python|get_cantera_mass_fraction|. With
these methods, the composition of the reactant mixture can be output to a format
that can be used to set the composition of a Cantera \python|Solution|. Note
that the \python|composition| specification is not required to contain the
molecular weights of the components, so calling
\python|get_cantera_mass_fraction| when \yaml|mole-percent| or
\yaml|mole-fraction| has been used in the \ck{} file will raise a
\python|ValueError| (and vice versa for \python|get_cantera_mole_fraction|).

The \python|ChemKED| class has one instance method defined, called
\python|get_dataframe|. Using this method, the user can get an instance of a
Pandas~\autocite{pandas} \python|DataFrame| that contains the information in the
list of \python|DataPoint|s. The user can specify the columns provided in the
\python|DataFrame| by passing a list of column names to the
\python|output_columns| argument of the \python|get_dataframe| function. The
possible columns are not case-sensitive and are:

\noindent\begin{itemize*}
    \item \python|'Temperature'|
    \item \python|'Pressure'|
    \item \python|'Ignition Delay'|
    \item \python|'Composition'|
    \item \python|'Equivalence Ratio'|
    \item \python|'Reference'|
    \item \python|'Apparatus'|
    \item \python|'Experiment Type'|
    \item \python|'File Author'|
    \item \python|'File Version'|
    \item \python|'ChemKED Version'|
\end{itemize*}

In addition, specific fields from the Reference and Apparatus attributes can
be included by specifying the name after a colon. These options are:

\noindent\begin{itemize*}
    \item \python|'Reference:Volume'|
    \item \python|'Reference:Journal'|
    \item \python|'Reference:DOI'|
    \item \python|'Reference:Authors'|
    \item \python|'Reference:Detail'|
    \item \python|'Reference:Year'|
    \item \python|'Reference:Pages'|
    \item \python|'Apparatus:Kind'|
\end{itemize*}

% This weirdness is necessary to prevent the list from running over the margin
\noindent\begin{itemize*}
    \item \python|'Apparatus:Facility'|
    \item \python|'Apparatus:Institution'|
\end{itemize*}

Only the first author is printed when \python|Reference| or
\python|Reference:Authors| is selected because the whole author list may be
quite long.

\pk{} relies on well-established scientific Python software tools. These include
NumPy~\autocite{vanderWalt:2011np} and Pandas~\autocite{pandas,McKinney2010} for
array manipulation, Pint~\autocite{Grecco2016} for interpreting and converting
between units, \texttt{ruamel.yaml}~\autocite{ruamel_yaml} for parsing YAML
files, Cerberus for validating \ck{} files~\autocite{cerberus}, and
pytest~\autocite{pytest:3.0.1} for unit testing. Travis-CI~\autocite{Travis2016}
provides continuous integration testing.

\todo[inline]{Need to archive version of PyKED and cite}
\todo[inline, author=Bryan]{Should we do this even without officially releasing a version?}

\pk{} is licensed under the permissive, open-source BSD 3-clause license. The
source code is publicly available on GitHub at
\url{https://github.com/pr-omethe-us/PyKED}. Installation of stable versions can
be accomplished from a package repository, using either \python|pip| to install
from \href{https://pypi.python.org/pypi}{PyPI} (Python Package Index), or
\python|conda| to install from the
\href{https://anaconda.org/conda-forge}{\texttt{conda-forge}} channel. In
addition, \pk{} can be installed from the source code by running \python|python
setup.py install| or \python|pip install .| from the root directory of the
repository.

%====================================================================
\section{Usage example}\label{sec:usage-example}
%
\todo[inline]{Bryan/Kyle to do}
\todo[inline]{Idea: CONV simulations using Cantera in a loop with conditions
from the Pandas output for butanol?}
\todo[inline]{Idea: VPRO simulations using Cantera from a \ck{} file for an RCM
datapoint}

The following usage examples provide a guide to the use of \pk{}. They are by no
means an exhaustive treatement, and are meant to demonstrate the basic
capabilities of the software.

\subsection{RCM modeling with varying reactor volume}\label{sec:rcm-modeling}

The \ck{} file that will be used in this example can be found in the
\python|tests| directory of the PyKED repository,
\url{https://github.com/pr-omethe-us/PyKED/blob/master/pyked/tests/testfile_rcm.yaml}.
Examining that file, we find the first section specifies the information about
the \ck{} file itself
%
\begin{minted}{yaml}
file-author:
  name: Kyle E Niemeyer
  ORCID: 0000-0003-4425-7097
file-version: (1, 0)
chemked-version: 0.0.1
fake-key: 0 # Again here because Atom's syntax highlighting is busted :(
\end{minted}
%
Then, we find the information regarding the article in the literature from which
this data was taken. In this case, the data point is from the work of \textcite{Mittal2006a}:
%
\begin{minted}{yaml}
reference:
  doi: 10.1002/kin.20180
  authors:
    - name: Gaurav Mittal
    - name: Chih-Jen Sung
      ORCID: 0000-0003-2046-8076
    - name: Richard A Yetter
  journal: International Journal of Chemical Kinetics
  year: 2006
  volume: 38
  pages: 516-529
  detail: Fig. 6, open circle
experiment-type: ignition delay
apparatus:
  kind: rapid compression machine
  institution: Case Western Reserve University
  facility: CWRU RCM
  fake-key: 0 # Again here because Atom's syntax highlighting is busted :(
\end{minted}

Finally, there is just a single datapoint in this file, which codes the ignition
delay for the experiment, the mixture composition, the initial temperature,
pressure,
%
\begin{minted}{yaml}
datapoints:
  - temperature: 297.4 kelvin
    ignition-delay: 1.0 ms
    pressure: 958.0 torr
    composition:
      - species-name: H2
        InChI: 1S/H2/h1H
        mole-fraction: 0.12500
      - species-name: O2
        InChI: 1S/O2/c1-2
        mole-fraction: 0.06250
      - species-name: N2
        InChI: 1S/N2/c1-2
        mole-fraction: 0.18125
      - species-name: Ar
        InChI: 1S/Ar
        mole-fraction: 0.63125
    ignition-type:
      target: pressure
      type: d/dt max
    compression-time: 38.0 ms
    volume-history:
      time:
        units: s
        column: 0
      volume:
        units: cm3
        column: 1
      values:
        - [0.00E+000, 5.47669375000E+002]
        - [1.00E-003, 5.46608789894E+002]
        - [2.00E-003, 5.43427034574E+002]
        - [3.00E-003, 5.38124109043E+002]
        - 0 # Dammit Atom
        ...
\end{minted}

The values for the \yaml|volume-history| are truncated to save space. The user
can load this file into \pk{} and run a simulation in Cantera with the following
code:

\begin{minted}{python}
import cantera as ct
from pyked import ChemKED

ck = ChemKED('testfile_rcm.yaml')
dp = ck.datapoints[0]

T_0 = dp.temperature.to('K').magnitude
P_0 = dp.pressure.to('Pa').magnitude
X_0 = dp.get_cantera_mole_fraction()

gas = ct.Solution('h2-co-mechanism.cti')
gas.TPX = T_0, P_0, X_0

reac = ct.IdealGasReactor(gas)
env = ct.Reservoir(ct.Solution('air.xml'))

time = dp.volume_history.time
volume = dp.volume_history.volume
ct.Wall(reac, env, velocity=VolumeProfile(time=time, volume=volume))

netw = ct.ReactorNet([reac])
while netw.time < 0.05:
    netw.step()

\end{minted}

\subsection{Shock tube modeling with constant volume}\label{sec:shock-tube}

The \ck{} file used in this example can be found online.\todo{add url}{}
The data in this file comes from Stranic et al.~\autocite{Stranic:2012}, describing
shock-tube ignition delays for \textit{tert}-butanol.
Examining the file, we first find the section that specifies the information about the \ck{} file itself:
%
\begin{minted}{yaml}
file-author:
  name: Morgan Mayer
  ORCID: 0000-0001-7137-5721
file-version: (0,1)
chemked-version: 0.0.1
screw-you-atom: 0
\end{minted}
%
Then the reference information:
%
\begin{minted}{yaml}
reference:
  doi: 10.1016/j.combustflame.2011.08.014
  authors:
    - name: Ivo Stranic
    - name: Deanna P. Chase
    - name: Joseph T. Harmon
    - name: Sheng Yang
    - name: David F. Davidson
    - name: Ronald K. Hanson
  journal: Combustion and Flame
  year: 2011
  volume: 159
  pages: 516-527
  detail:
experiment-type: ignition delay
apparatus:
  kind: shock tube
  institution: High Temperature Gasdynamics Laboratory, Stanford University
  facility: stainless steel shock tube
dammit-atom: 0
\end{minted}
%
In this \ck{} file, multiple data points are specified with some common
conditions, including a common mixture composition and common defintion of
ignition delay. Therefore, a \yaml|common-properties| section is specified.
%
\begin{minted}{yaml}
common-properties:
  composition: &comp
    - species-name: t-butanol
      InChI: 1S/C4H10O/c1-4(2,3)5/h5H,1-3H3
      mole-fraction: 0.003333333
    - species-name: O2
      InChI:  1S/O2/c1-2
      mole-fraction: 0.04
    - species-name: Ar
      InChI:  1S/Ar
      mole-fraction: 0.956666667
  ignition-type:  &ign
    target: OH* concentration
    type: 1/2 max
atom-is-bad-at-syntax-highlighting: 0
\end{minted}
%
This block utilizes the ability of YAML files to define an anchor using the
\yaml|&| symbol and refer to that section later using the \yaml|*| symbol, as
can be seen in the definition of the \yaml|datapoints| section:
%
\begin{minted}{yaml}
datapoints:
  - temperature: 1459 kelvin
    ignition-delay: 347 us
    pressure: 1.60 atm
    composition: *comp
    ignition-type: *ign
    equivalence-ratio: 0.5
  - temperature: 1389 kelvin
    ignition-delay: 756 us
    pressure: 1.67 atm
    composition: *comp
    ignition-type: *ign
    equivalence-ratio: 0.5
  - temperature: 1497 kelvin
    ignition-delay: 212 us
    pressure: 1.55 atm
    composition: *comp
    ignition-type: *ign
    equivalence-ratio: 0.5
  - temperature: 1562 kelvin
    ignition-delay: 105 us
    pressure: 1.50 atm
    composition: *comp
    ignition-type: *ign
    equivalence-ratio: 0.5
\end{minted}

In this example, we would like to run constant volume simulations at each of the
pressure and temperature conditions in the \yaml|datapoints| list.

\begin{minted}{python}
import cantera as ct
from pyked import ChemKED

ck = ChemKED('Stranic2012-tbuoh.yaml')

gas = ct.Solution('tbuoh-mechanism.cti')

X_0 = ck.datapoints[0].get_cantera_mole_fraction()

for dp in ck.datapoints:
    T_0 = dp.temperature.to('K').magnitude
    P_0 = dp.pressure.to('Pa').magnitude
    gas.TPX = T_0, P_0, X_0
    reac = ct.IdealGasReactor(gas)
    netw = ct.ReactorNet([reac])
    while reac.T < T_0 + 400:
        netw.step()

    print('The ignition delay for T_0={}, P_0={} is: {} seconds'.format(
        T_0, P_0, netw.time
    ))
\end{minted}
%====================================================================
\section{Conclusions and future work}
%
\todo[inline]{both to do}

In this article, we introduced the \ck{} data format for describing measurements
taken from fundamental combustion experiments, as well as the Python-based tool
\pk{} for working with the format. Currently, \ck{} supports ignition delay data
from studies using shock tubes and rapid compression machines.

We are currently incorporating support for specifying uncertainty in all quantities.
Version 1.0 of \ck{}\slash \pk{} will include ...
Later versions will support measurements from additional fundamental experiments,
including laminar flames and flow reactors.

\printbibliography

\end{document}
